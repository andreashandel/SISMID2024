{
  "hash": "c7799a65bbfdf5785e923fab4ce67bdd",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Viral Infection models\"\ndate: \"2024-07-17 14:04:30.790937\"\nauthor: \"[Andreas Handel](https://www.andreashandel.com)\"\nformat: \n  revealjs:\n    theme: default\n    css: \"./media/handelslides.css\"\n    transition: none\n    incremental: false\n    cap-location: bottom\n    self-contained: true\n    slide-number: true\n    show-slide-number: all\n    auto-stretch: true\n    smaller: true\n---\n\n\n\n\n\n## Basic acute virus infection model\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./media/emptyvirusdiagram.png){fig-align='center' width=70%}\n:::\n:::\n\n\n\n$$\n\\begin{aligned}\n\\textrm{Uninfected Cells} \\qquad \\dot{U} & =  ? \\\\\n\\textrm{Infected Cells} \\qquad \\dot{I} & =  ? \\\\     \n\\textrm{Virus} \\qquad  \\dot{V} & =  ? \n\\end{aligned}\n$$\n\n## Basic acute virus infection model\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./media/virusdiagram.png){fig-align='center' width=70%}\n:::\n:::\n\n\n\n$$\n\\begin{aligned}\n\\textrm{Uninfected Cells} \\qquad \\dot{U} & =   - bUV \\\\\n\\textrm{Infected Cells} \\qquad \\dot{I} & =  bUV - d_I I \\\\     \n\\textrm{Virus} \\qquad  \\dot{V} & =  pI - d_V V -  bg UV \n\\end{aligned}\n$$\n\n\n\n## Basic chronic virus infection model\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./media/chronicvirusmodel.png){fig-align='center' width=70%}\n:::\n:::\n\n\n\n$$\n\\begin{aligned}\n\\textrm{Uninfected Cells} \\qquad \\dot{U} & = \\color{blue}{n -d_U U} - bUV \\\\\n\\textrm{Infected Cells} \\qquad \\dot{I} & =  bUV - d_I I \\\\     \n\\textrm{Virus} \\qquad  \\dot{V} & =  pI - d_V V -  bg UV \n\\end{aligned}\n$$\n\n## Basic virus infection models\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Dynamics of simple viral infection models. A) acute infection. B) chronic infection.](./media/virusmodels.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\n\n## Notation variability\n* I'm trying to use the same letters for variables and parameters in these materials.\n* If you read the literature, you'll see all kinds of variants.\n\n$$\n\\dot{T} = s - uT - \\beta T V \\\\\n\\dot{T^*}  =  \\beta T V - d T^* \\\\\n\\dot{V}  =  NdT^* - c V -  \\beta g TV \n$$\n$$\n\\dot{x} = \\lambda - dx - \\beta x v \\\\\n\\dot{y}  =  \\beta x v - a y \\\\\n\\dot{v}  =  \\kappa y - u v -  \\beta g xv \n$$\n\n\n## Diagrams and Models\n* It is important to go back and forth between words, diagrams, equations.\n* Diagrams specify a model somewhat, but not completely. \n\n\n## Diagrams and Models\nThe virus model diagram could be implemented as continuous or discrete (or stochastic) model.\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./media/chronicvirusmodel.png){fig-align='center' width=70%}\n:::\n:::\n\n\n\n$$\n\\begin{aligned}\n\\dot{U} & = n -d_U U - bUV \\\\\n\\dot{I} & =  bUV - d_I I \\\\     \n\\dot{V} & =  pI - d_V V -  bg UV \n\\end{aligned}\n$$\n\n$$\n\\begin{aligned}\nU_{t+dt} & = U_{t} + dt(n -d_U U_t - bU_tV_t) \\\\\nI_{t+dt} & = I_{t} + dt( bU_tV_t - d_I I_t )\\\\     \nV_{t+dt} & = V_{t} + dt( pI_t - d_V V_t -  bg U_t V_t ) \n\\end{aligned}\n$$\n\n\n## Model Exploration\nExplore the \"Basic Virus Model\" app in DSAIRM\n\n\n## Virus and Immune Response Models\n* The immune response is incredibly complex, we still don't know how to model it in much detail.\n* We can nevertheless build and explore models that are a (hopefully) good balance between realism and abstraction.\n\n\n## Virus and Immune Response Model 1\n\n* **U** - uninfected cells \n* **I** - infected cells\n* **V** - (free) virus\n* **F** - innate (interferon) response\n* **T** - adaptive (T-cell) response\n\n## Virus and Immune Response Model 1\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./media/acutevirusir.png){fig-align='center' width=70%}\n:::\n:::\n\n\n\n## Virus and Immune Response Model 1\n\n\n\\begin{aligned}\n\\dot U & = - b U V  \\\\\n\\dot I & = b U V - d_I I - k_T T I   \\\\\n\\dot V & = \\frac{p}{1+k_F F}I - d_V V - gb UV \\\\\n\\dot F & = r_F I - d_F F \\\\\n\\dot T & = r_T T F - d_T T\n\\end{aligned}\n\n\n\n## Virus and Immune Response Model 2\n\n* **U** - uninfected cells \n* **I** - infected cells\n* **V** - (free) virus\n* **F** - innate (interferon) response\n* **T** - adaptive (T-cell) response\n\n\n## Virus and Immune Response Model 2\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./media/chronicvirusir.png){fig-align='center' width=70%}\n:::\n:::\n\n\n\n\n## Virus and Immune Response Model 2\n\n\\begin{aligned}\n\\dot U & = n - d_U U - b U V  \\\\\n\\dot I & = bUV - d_I I - k_T T I   \\\\\n\\dot V & = \\frac{p}{1+k_F F}I - d_V V - gb UV \\\\\n\\dot F & = r_F I - d_F F \\\\\n\\dot T & = r_T T V - d_T T\n\\end{aligned}\n\n## Models 1 and 2\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n\\begin{aligned}\n\\dot U & = - b U V  \\\\\n\\dot I & = b U V - d_I I - k_T T I   \\\\\n\\dot V & = \\frac{p}{1+k_F F}I - d_V V - gb UV \\\\\n\\dot F & = r_F I - d_F F \\\\\n\\dot T & = r_T T F - d_T T\n\\end{aligned}\n:::\n\n::: {.column width=\"50%\"}\n\\begin{aligned}\n\\dot U & = \\color{blue}{n - d_U U} - b U V  \\\\\n\\dot I & = bUV - d_I I - k_T T I   \\\\\n\\dot V & = \\frac{p}{1+k_F F}I - d_V V - gb UV \\\\\n\\dot F & = r_F I - d_F F \\\\\n\\dot T & = \\color{blue}{r_T T V} - d_T T\n\\end{aligned}\n:::\n::::\n\n\n\n\n\n## Virus and Immune Response Model 3\n\n\n* **U** - uninfected cells \n* **I** - infected cells\n* **V** - (free) virus\n* **F** - innate immune response\n* **T** - CD8 T-cells\n* **B** - B-cells\n* **A** - Antibodies\n\n\n## Model Diagram\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./media/virusandIRmodel.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n\n## Model Equations\n$$\n\\dot U = n - d_U U - bUV\\\\ \n\\dot I = bUV - d_I I - k_T T I\\\\\n\\dot V = \\frac{pI}{1+s_F F} - d_V V - b UV - k_A AV \\\\\n\\dot F = p_F - d_F F + \\frac{V}{V+ h_V}g_F(F_{max}-F)  \\\\ \n\\dot T = F V g_T + r_T T\\\\\n\\dot B = \\frac{F V}{F V + h_F} g_B B \\\\\n\\dot A = r_A B - d_A A - k_A A V\n$$\n\n## Model Exploration\nExplore any/all of the \"IR\" models in the virus models section\n\n<!-- ## Homework -->\n\n<!-- * If you haven't already, take a look at the \"Basic Bacteria Model\" app and - in as much detail as you have time - go through the \"What to do\" tasks. You can try yourself first, or look at the solution right away. -->\n<!-- * Take an especially close look at the solution for task 6, we will use a similar approach tomorrow. -->\n<!-- * Link to solution file is in the schedule of the class website.  -->\n\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}